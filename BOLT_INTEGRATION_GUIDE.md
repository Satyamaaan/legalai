# BOLT_INTEGRATION_GUIDE.md
Generate, organize, and integrate a **ShadCN + React** front-end‚Äîauto-generated by [bolt.new](https://bolt.new)‚Äîwith the existing Flask backend of **LegalAI**.

---

## 1. Prerequisites
| Tool | Version / Notes |
|------|-----------------|
| Node | ‚â• 18 |
| pnpm | `npm i -g pnpm` |
| Python backend | Running at `http://localhost:5000` |
| CORS | Backend `.env` ‚Üí `ALLOWED_ORIGINS=http://localhost:5001` |

---

## 2. Create Front-End Workspace

```bash
# in repo root
pnpm create vite frontend --template react-ts
cd frontend
pnpm i                # install deps
```

### Add required libraries

```bash
pnpm add @tanstack/react-query axios
pnpm add -D tailwindcss postcss autoprefixer
npx shadcn-ui@latest init     # installs shadcn/ui & tailwind config
```

> Resulting tree (only top level):

```
frontend/
‚îú‚îÄ src/
‚îÇ  ‚îú‚îÄ components/      # bolt.new output goes here
‚îÇ  ‚îú‚îÄ pages/
‚îÇ  ‚îú‚îÄ lib/
‚îÇ  ‚îî‚îÄ main.tsx
‚îú‚îÄ index.html
‚îî‚îÄ vite.config.ts
```

---

## 3. Generate Components with bolt.new

Open https://bolt.new, paste the **prompt**, choose *React + TypeScript + Tailwind*, click **Generate**, then copy the resulting file(s) into `frontend/src/components`.

| Component | Prompt to paste in bolt.new |
|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| UploadDropzone | *Generate a React + TS component named **UploadDropzone** using shadcn/ui and Tailwind.<br>- Accept `.pdf` files up to 20 MB.<br>- Shows dashed border, icon, drag-and-drop.<br>- Fires `onFileAccepted(File)` prop when valid.<br>- Show toast error via shadcn/toast on invalid file.<br>- Fully responsive.* |
| ModalProgress | *Create **ModalProgress** component with shadcn/ui Dialog.<br>- Props: `open:boolean`, `progress:number`, `stage:string`.<br>- Indeterminate bar when progress 0.<br>- Centered modal.* |
| JobStatusCard | *React TS component **JobStatusCard**.<br>- Prop `job:{id,status,progress,error_message?}`.<br>- Shows Progress bar, status badge (color coded), retry button visible when status "error".* |
| DownloadCard | *Component **DownloadCard**.<br>- Props: `downloadUrl:string`, `filename:string`.<br>- Success icon, filename, ‚ÄúDownload‚Äù button linking `downloadUrl` target ‚Äú_blank‚Äù.* |

*(Optional future)* HistoryPage prompt in `FRONTEND_USER_FLOW.md`.

---

## 4. Wire Up API Calls

### 4.1 Create `src/lib/api.ts`

```ts
import axios from "axios";
export const api = axios.create({
  baseURL: import.meta.env.VITE_API_URL || "http://localhost:5000",
});

export const getSignedUrl = (filename: string) =>
  api.post("/api/upload/signed-url", {
    filename,
    content_type: "application/pdf",
  });

export const confirmUpload = (job_id: string) =>
  api.post("/api/upload/confirm", { job_id });

export const startTranslate = (job_id: string) =>
  api.post(`/api/translate/start/${job_id}`);

export const getStatus = (job_id: string) =>
  api.get(`/api/upload/status/${job_id}`);

export const getDownloadUrl = (job_id: string) =>
  api.get(`/api/download/job/${job_id}`, { params: { redirect: false } });
```

### 4.2 Env file

`frontend/.env`  
```
VITE_API_URL=http://localhost:5000
```

---

## 5. Implement Pages

### 5.1 Landing / Upload page (`src/pages/Home.tsx` ‚Äì skeleton)

```tsx
import { useState } from "react";
import { UploadDropzone } from "@/components/UploadDropzone";
import { ModalProgress } from "@/components/ModalProgress";
import { JobStatusCard } from "@/components/JobStatusCard";
import { DownloadCard } from "@/components/DownloadCard";
import {
  getSignedUrl,
  confirmUpload,
  startTranslate,
  getStatus,
  getDownloadUrl,
} from "@/lib/api";

export default function Home() {
  const [jobId, setJobId] = useState<string>();
  const [job, setJob] = useState<any>();
  const [modal, setModal] = useState<{ open: boolean; progress: number; stage: string }>({ open: false, progress: 0, stage: "uploading" });

  /** 1. handle file selection */
  const handleFile = async (file: File) => {
    setModal({ open: true, progress: 0, stage: "uploading" });
    const { data } = await getSignedUrl(file.name);
    await fetch(data.upload_url, { method: "PUT", body: file }); // direct upload
    await confirmUpload(data.job_id);
    await startTranslate(data.job_id);
    setJobId(data.job_id);
    pollStatus(data.job_id);
  };

  /** 2. poll status */
  const pollStatus = (id: string) => {
    const interval = setInterval(async () => {
      const { data } = await getStatus(id);
      setJob(data);
      setModal((m) => ({ ...m, progress: data.progress, stage: data.status }));
      if (["done", "error"].includes(data.status)) clearInterval(interval);
    }, 3000);
  };

  /** 3. download */
  const download = async () => {
    if (!jobId) return;
    const { data } = await getDownloadUrl(jobId);
    window.open(data.download_url, "_blank");
  };

  return (
    <main className="container mx-auto p-6">
      {!job && <UploadDropzone onFileAccepted={handleFile} />}
      {job && job.status !== "done" && <JobStatusCard job={job} />}
      {job && job.status === "done" && (
        <DownloadCard downloadUrl="#" filename="translated.pdf" onDownload={download} />
      )}
      <ModalProgress open={modal.open} progress={modal.progress} stage={modal.stage} />
    </main>
  );
}
```

### 5.2 Routing (`src/App.tsx`)

```tsx
import { BrowserRouter, Routes, Route } from "react-router-dom";
import Home from "@/pages/Home";

export default function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<Home />} />
      </Routes>
    </BrowserRouter>
  );
}
```

---

## 6. Run Both Apps

### 6.1 Backend

```bash
# repo root
python app/main.py
```

### 6.2 Frontend

```bash
cd frontend
pnpm dev --port 5001
```

Open http://localhost:5001 ‚Äì drag a PDF and watch progress!

---

## 7. Testing Checklist

| Item | Command / Action | Expected |
|------|------------------|----------|
| Backend running | `curl http://localhost:5000/health` | `{"status":"healthy"}` |
| Signed URL | JS console ‚Üí `getSignedUrl("x.pdf")` | 200 JSON |
| Upload flow | Drag PDF in UI | Progress 0‚Üí100, ‚ÄúDownload‚Äù appears |
| Download | Click Download | New tab downloads translated PDF |

---

## 8. Next Enhancements

1. Replace polling with Supabase Realtime (`translation_jobs` channel).  
2. Add `HistoryPage` for previously translated docs.  
3. Auth via Supabase; secure job access.  
4. Deployment: build React `pnpm build` ‚Üí copy `dist/` into Flask `static/`.

---

**üéâ You now have a fully-functional bolt-generated front-end talking to your Flask back-end!**
